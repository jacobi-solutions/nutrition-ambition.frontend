<ion-header>
  <ion-toolbar>
    <ion-title>Shift All Dates</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="dismiss()">
        <ion-icon name="close-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <div class="modal-content">
    <!-- Account Info -->
    <div class="account-info">
      <h3>{{ account.name || 'Unnamed' }}</h3>
      <p class="email">{{ account.email }}</p>
    </div>

    <!-- Shift All Dates Section -->
    <div class="date-section">
      <div class="section-header">
        <ion-icon name="calendar-outline"></ion-icon>
        <h4>Day Shift</h4>
      </div>

      <!-- Current dates reference -->
      <div class="current-values">
        <div class="current-value">
          <span class="label">Created:</span>
          <span class="value">{{ formatDate(account.createdDateUtc) }}</span>
        </div>
        <div class="current-value">
          <span class="label">Trial End:</span>
          <span class="value">{{ formatDate(account.trialEndDateUtc) }}</span>
        </div>
      </div>

      <div class="adjustment-controls">
        <ion-button
          fill="outline"
          size="small"
          (click)="decrementDayShift()"
          [disabled]="isSubmitting">
          <ion-icon name="remove-outline"></ion-icon>
        </ion-button>

        <div class="adjustment-value" [class.negative]="dayShift < 0" [class.positive]="dayShift > 0">
          {{ dayShift >= 0 ? '+' : '' }}{{ dayShift }} days
        </div>

        <ion-button
          fill="outline"
          size="small"
          (click)="incrementDayShift()"
          [disabled]="isSubmitting">
          <ion-icon name="add-outline"></ion-icon>
        </ion-button>
      </div>

      <!-- Projected values -->
      <div class="projected-values" *ngIf="dayShift !== 0">
        <div class="projected-value" *ngIf="account.createdDateUtc">
          <span class="label">New Created:</span>
          <span class="value projected">{{ formatDate(getProjectedCreatedDate()) }}</span>
        </div>
        <div class="projected-value" *ngIf="account.trialEndDateUtc">
          <span class="label">New Trial End:</span>
          <span class="value projected">{{ formatDate(getProjectedTrialEndDate()) }}</span>
        </div>
      </div>

      <ion-button
        expand="block"
        color="primary"
        [disabled]="dayShift === 0 || isSubmitting"
        (click)="applyShift()">
        <ion-spinner *ngIf="isSubmitting" name="crescent" slot="start"></ion-spinner>
        <ion-icon *ngIf="!isSubmitting" name="checkmark-outline" slot="start"></ion-icon>
        Apply Shift
      </ion-button>
    </div>

    <ion-note class="hint">
      Shifts ALL dates across all collections: Account, ChatMessages, FoodEntries, DailySummaries, UserProfiles, DailyTargets, MealSelections, and FoodFavorites.
      <br><br>
      Negative values move dates back (simulating an older account). Positive values move forward (future-dated records will be deleted).
    </ion-note>
  </div>
</ion-content>
