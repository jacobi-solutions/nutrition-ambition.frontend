<ion-grid *ngIf="hasData" [class.animate]="isVisible">
  <ion-row>
    <!-- Electrolytes Variable-Radius Pie Chart -->
    <ion-col size="12">
      <div class="chart-wrapper">
        <div class="electrolytes-chart-container">
          <span class="animation-label targets-label" *ngIf="hasTargets">Targets</span>
          <span class="animation-label actual-label">Actual</span>

          <div class="electrolytes-chart">
            <svg [attr.viewBox]="viewBox">
              <!-- Actual consumption segments (variable radius) - render first -->
              <g class="actual-segments">
                <path *ngFor="let electrolyte of electrolytes"
                      class="segment"
                      [attr.class]="'segment ' + electrolyte.key + '-segment'"
                      [attr.d]="electrolyte.segmentPath"
                      [attr.fill]="electrolyte.color">
                </path>
              </g>

              <!-- Target rings (thin outer rings at 100%) - render on top -->
              <g class="target-rings" [class.no-targets]="!hasTargets">
                <circle *ngFor="let electrolyte of electrolytes"
                        class="target-ring"
                        [attr.class]="'target-ring ' + electrolyte.key + '-target'"
                        cx="50" cy="50"
                        [attr.r]="targetRingRadius"
                        [attr.stroke]="electrolyte.color"
                        [attr.stroke-dasharray]="electrolyte.targetStrokeDasharray"
                        [attr.stroke-dashoffset]="electrolyte.targetStrokeDashoffset"
                        [attr.transform]="'rotate(-90 50 50)'">
                </circle>
              </g>

              <!-- Percentage labels - render last on top of everything -->
              <g class="percentage-labels">
                <text *ngFor="let electrolyte of electrolytes"
                      class="percentage-label"
                      [attr.x]="electrolyte.labelX"
                      [attr.y]="electrolyte.labelY"
                      text-anchor="middle"
                      dominant-baseline="middle">
                  {{ electrolyte.percentage }}%
                </text>
              </g>
            </svg>
          </div>

          <div class="chart-tip" *ngIf="hasTargets">
            Make each slice of the pie grow at the same rate. Try to stop when you hit the outer ring!
          </div>
          <div class="chart-tip" *ngIf="!hasTargets">
            Track your electrolyte intake throughout the day
          </div>
        </div>

        <!-- Legend -->
        <div class="chart-values">
          <div class="value-item" *ngFor="let electrolyte of electrolytes">
            <span class="value-dot" [style.background-color]="electrolyte.color"></span>
            <span class="value-label">{{ electrolyte.name }}:</span>
            <span class="value-number" *ngIf="hasTargets">{{ electrolyte.consumed }}mg / {{ electrolyte.target }}mg</span>
            <span class="value-number" *ngIf="!hasTargets">{{ electrolyte.consumed }}mg</span>
          </div>
        </div>
      </div>
    </ion-col>
  </ion-row>
</ion-grid>

<!-- Empty state -->
<div class="empty-state" *ngIf="!hasData">
  <div class="empty-state-content">
    <ion-icon name="nutrition-outline" class="empty-state-icon"></ion-icon>
    <h2>Nothing logged yet</h2>
    <p>No meals or foods have been logged for this date.</p>
    <p>Head over to the Chat tab to start tracking your electrolytes!</p>
  </div>
</div>
